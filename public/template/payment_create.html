<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Judul Halaman -->
    <title>
      Aplikasi Pembayaran Iuran Madrasah Ibtidaiyah Ihyauddiniyah Desa Kecil
      Besuk Probolinggo
    </title>

    <!-- Meta begin -->
    <!-- Set Karakter -->
    <meta charset="utf-8" />
    <!-- Mode Rendering -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Penulis Halaman -->
    <meta name="author" content="Madrasah Ibtidaiyah Ihyauddiniyah" />
    <!-- Pengindeksan Mesin Pencari -->
    <meta name="robots" content="index, follow" />

    <!-- Kata Kunci SEO -->
    <meta
      name="keywords"
      content="Pembayaran Iuran, Madrasah Ibtidaiyah Ihyauddiniyah, Desa Kecil Besuk, Probolinggo, Aplikasi Pembayaran, Sistem Pembayaran Iuran, Pendidikan, Madrasah Ibtidaiyah, Manajemen Keuangan, Desain Responsif, UI Modern, Aplikasi Web, Sistem Administrasi, Pembayaran Mudah, Pengelolaan Iuran, Formulir Pembayaran, Pembayaran Online, Solusi Keuangan Madrasah"
    />

    <!-- Deskripsi Halaman -->
    <meta
      name="description"
      content="Aplikasi Pembayaran Iuran untuk Madrasah Ibtidaiyah Ihyauddiniyah di Desa Kecil Besuk Probolinggo. Aplikasi ini memudahkan proses pembayaran iuran, melacak transaksi keuangan, dan mengelola administrasi dengan desain responsif dan fitur yang user-friendly."
    />

    <!-- Metadata Open Graph -->
    <meta
      property="og:title"
      content="Aplikasi Pembayaran Iuran Madrasah Ibtidaiyah Ihyauddiniyah Desa Kecil Besuk Probolinggo"
    />
    <meta
      property="og:description"
      content="Aplikasi Pembayaran Iuran untuk Madrasah Ibtidaiyah Ihyauddiniyah di Desa Kecil Besuk Probolinggo. Aplikasi ini memudahkan proses pembayaran iuran, melacak transaksi keuangan, dan mengelola administrasi dengan desain responsif dan fitur yang user-friendly."
    />
    <meta property="og:image" content="social-image.png" />

    <!-- Twitter Card Metadata -->
    <meta
      name="twitter:title"
      content="Aplikasi Pembayaran Iuran Madrasah Ibtidaiyah Ihyauddiniyah Desa Kecil Besuk Probolinggo"
    />
    <meta
      name="twitter:description"
      content="Aplikasi Pembayaran Iuran untuk Madrasah Ibtidaiyah Ihyauddiniyah di Desa Kecil Besuk Probolinggo. Aplikasi ini memudahkan proses pembayaran iuran, melacak transaksi keuangan, dan mengelola administrasi dengan desain responsif dan fitur yang user-friendly."
    />
    <meta name="twitter:image" content="social-image.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <!-- Meta end -->

    <!-- Mobile Specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="16x16" href="images/logo_mi.png" />

    <link href="vendor/jqvmap/css/jqvmap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="vendor/chartist/css/chartist.min.css" />
    <link
      href="vendor/bootstrap-select/dist/css/bootstrap-select.min.css"
      rel="stylesheet"
    />
    <link href="vendor/owl-carousel/owl.carousel.css" rel="stylesheet" />

    <link href="vendor/sweetalert2/dist/sweetalert2.min.css" rel="stylesheet" />
    <link class="main-css" href="css/style.css" rel="stylesheet" />
  </head>

  <body>
    <!-- Preloader start -->
    <div id="preloader">
      <!-- Bouncing animation container -->
      <div class="sk-three-bounce">
        <!-- Individual bouncing elements -->
        <div class="sk-child sk-bounce1"></div>
        <div class="sk-child sk-bounce2"></div>
        <div class="sk-child sk-bounce3"></div>
      </div>
    </div>
    <!-- Preloader end -->

    <!--Main wrapper start-->
    <div id="main-wrapper">
      <!-- Nav header start -->
      <div class="nav-header">
        <!-- Brand logo with different images for various screen sizes -->
        <a href="index.html" class="brand-logo">
          <!-- Logo for abbreviated view (e.g., mobile) -->
          <!-- <img class="logo-abbr" src="images/logo.png" alt="" /> -->
          <img class="logo-abbr" src="images/logo_mi.png" alt="" />
          <!-- Compact logo with text (e.g., for sidebar) -->
          <!-- <img class="logo-compact" src="images/logo-text.png" alt="" /> -->
          <img class="logo-compact" src="images/logo_mi.png" alt="" />
          <!-- Full brand title logo -->
          <!-- <img class="brand-title" src="images/logo-text.png" alt="" /> -->
          <!-- <img class="brand-title" src="images/logo-text.png" alt="" /> -->
        </a>

        <!-- Navigation control for mobile view -->
        <div class="nav-control">
          <div class="hamburger">
            <!-- Hamburger menu lines for toggling navigation -->
            <span class="line"></span><span class="line"></span
            ><span class="line"></span>
          </div>
        </div>
      </div>
      <!-- Nav header end -->

      <!-- Header start -->
      <div class="header">
        <div class="header-content">
          <!-- Navbar with expandable and collapsible features -->
          <nav class="navbar navbar-expand">
            <div class="collapse navbar-collapse justify-content-between">
              <!-- Left side of the header -->
              <div class="header-left">
                <!-- Dashboard bar placeholder -->
                <div class="dashboard_bar"></div>
              </div>
              <!-- Right side of the header with navigation items -->
              <ul class="navbar-nav header-right">
                <!-- Weather detail item -->
                <li class="nav-item">
                  <div class="d-flex weather-detail">
                    <span><i class="las la-cloud"></i></span>
                    Probolinggo, IDN
                  </div>
                </li>
                <!-- Theme mode toggle dropdown -->
                <li class="nav-item dropdown notification_dropdown">
                  <a
                    class="nav-link bell dz-theme-mode"
                    href="javascript:void(0);"
                  >
                    <i id="icon-light" class="fas fa-sun"></i>
                    <i id="icon-dark" class="fas fa-moon"></i>
                  </a>
                </li>
                <!-- User profile dropdown -->
                <li class="nav-item dropdown header-profile">
                  <a
                    class="nav-link"
                    href="javascript:void(0)"
                    role="button"
                    data-bs-toggle="dropdown"
                  >
                    <div class="header-info">
                      <span class="text-black"
                        >Hello,<strong>Franklin</strong></span
                      >
                      <p class="fs-12 mb-0">Super Admin</p>
                    </div>
                    <img
                      src="images/profile/17.jpg"
                      width="20"
                      alt="User Profile Picture"
                    />
                  </a>
                  <!-- Dropdown menu with profile and logout options -->
                  <div class="dropdown-menu dropdown-menu-end">
                    <a href="app-profile.html" class="dropdown-item ai-icon">
                      <i
                        class="fas fa-user text-primary"
                        style="font-size: 18px"
                      ></i>
                      <span class="ms-2">Profile</span>
                    </a>
                    <a href="page-login.html" class="dropdown-item ai-icon">
                      <i
                        class="fas fa-sign-out-alt text-danger"
                        style="font-size: 18px"
                      ></i>
                      <span class="ms-2">Logout</span>
                    </a>
                  </div>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
      <!-- Header end -->

      <!-- Sidebar start -->
      <div class="deznav">
        <div class="deznav-scroll">
          <!-- Sidebar menu -->
          <ul class="metismenu" id="menu">
            <!-- Main section -->
            <li>
              <a
                class="has-arrow ai-icon"
                href="javascript:void(0);"
                aria-expanded="false"
              >
                <i class="fas fa-chart-line fw-bold"></i>
                <span class="nav-text">Main</span>
              </a>
              <ul aria-expanded="false">
                <li><a href="index.html" class="fs-6">Dashboard</a></li>
              </ul>
            </li>
            <!-- Payment section -->
            <li>
              <a
                class="has-arrow ai-icon"
                href="javascript:void(0);"
                aria-expanded="false"
              >
                <i class="fas fa-money-check-alt fw-bold"></i>
                <span class="nav-text">Payment</span>
              </a>
              <ul aria-expanded="false">
                <li>
                  <a href="payment_create.html" class="fs-6">Create Payment</a>
                </li>
                <li>
                  <a href="payment_history.html" class="fs-6"
                    >History Payment</a
                  >
                </li>
              </ul>
            </li>
            <!-- Master section -->
            <li>
              <a
                class="has-arrow ai-icon"
                href="javascript:void(0);"
                aria-expanded="false"
              >
                <i class="fas fa-server fw-bold"></i>
                <span class="nav-text">Master</span>
              </a>
              <ul aria-expanded="false">
                <li>
                  <a href="master_academic_year.html" class="fs-6"
                    >Academic Year</a
                  >
                </li>
                <li><a href="mater_student.html" class="fs-6">Student</a></li>
              </ul>
            </li>
            <!-- Fees section -->
            <li>
              <a
                class="has-arrow ai-icon"
                href="javascript:void(0);"
                aria-expanded="false"
              >
                <i class="fas fa-rupiah-sign fw-bold"></i>
                <span class="nav-text">Fees</span>
              </a>
              <ul aria-expanded="false">
                <li><a href="fee_setting.html" class="fs-6">Fee Setting</a></li>
                <li>
                  <a href="fee_exemption.html" class="fs-6">Fee Exemption</a>
                </li>
              </ul>
            </li>
          </ul>

          <!-- Footer with copyright information -->
          <div class="copyright">
            <p><strong>Payment App</strong> © 2024 All Rights Reserved</p>
            <p>Developed by _LnH'79</p>
          </div>
        </div>
      </div>
      <!-- Sidebar end -->

      <!-- Content body start-->
      <div class="content-body default-height">
        <!-- row -->
        <div class="container-fluid">
          <div class="form-head mb-4">
            <h2 class="text-black font-w600 mb-0">Payment</h2>
          </div>
          <!-- coba -->
          <div class="row">
            <div class="card">
              <div class="card-header d-sm-flex d-block border-0 flex-wrap">
                <div class="pr-3 me-auto mb-sm-0 mb-3">
                  <h4 class="fs-20 text-black mb-1">Create Payment</h4>
                  <span class="fs-12">Choose acdemic year and student</span>
                </div>
                <div
                  class="d-flex align-items-center justify-content-between gap-1"
                >
                  <select
                    id="academic-year"
                    class="default-select form-control form-control-sm wide"
                  >
                    <option value="2023/2024 | Ganjil">
                      2023/2024 | Ganjil
                    </option>
                    <option value="2022/2023 | Genap">2022/2023 | Genap</option>
                    <option value="2021/2022 | Ganjil">
                      2021/2022 | Ganjil
                    </option>
                    <option value="2020/2021 | Genap">2020/2021 | Genap</option>
                    <option value="2019/2020 | Ganjil">
                      2019/2020 | Ganjil
                    </option>
                  </select>
                  <select
                    id="student-select"
                    class="default-select form-control form-control-sm wide"
                  >
                    <option>Student 1</option>
                    <option>Student 2</option>
                    <option>Student 3</option>
                  </select>
                </div>
              </div>
              <div class="card-body">
                <h4 class="mb-4">Informasi Siswa</h4>
                <div class="row mb-4">
                  <div class="col-xl-4 col-lg-4 col-sm-12 mb-4">
                    <div class="alert alert-outline-light">
                      <h4 class="mb-3">Data diri</h4>
                      <ul class="list-group list-group-flush">
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>NIS</strong>
                          <span class="mb-0">123243</span>
                        </li>
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Nama</strong>
                          <span class="mb-0">Luthfi Nurul Huda</span>
                        </li>
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Kelas</strong>
                          <span class="mb-0">6</span>
                        </li>
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Peringkat</strong>
                          <span class="mb-0">1</span>
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="col-xl-8 col-lg-8 col-sm-12 mb-4">
                    <div class="alert alert-outline-light">
                      <h4 class="mb-3">Keterangan</h4>
                      <ul class="list-group list-group-flush">
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Anak Guru?</strong>
                          <span class="mb-0 badge light badge-success"
                            >Ya - Diskon 10%</span
                          >
                        </li>
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Peringkat 1-3?</strong>
                          <span class="mb-0 badge light badge-success"
                            >Ya - Diskon 10%</span
                          >
                        </li>
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Anak Yatim/Kurang Mampu?</strong>
                          <span class="mb-0 badge light badge-success"
                            >Ya - Diskon 10%</span
                          >
                        </li>
                        <li
                          class="list-group-item d-flex p-1 justify-content-between m-1"
                        >
                          <strong>Potongan Saudara?</strong>
                          <span class="mb-0 badge light badge-danger"
                            >Tidak - Diskon 0%</span
                          >
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>

                <hr class="my-4 border-primary" />

                <h4 class="mb-4">
                  Detail Pembayaran Siswa Tahun Ajaran 2023/2024
                </h4>
                <div id="payment-details" class="table-responsive mb-4"></div>

                <hr class="my-4 border-primary" />

                <div class="mt-4">
                  <h4 class="mb-3">Tambah Pembayaran</h4>
                  <form id="payment-form">
                    <div id="fee-forms" class="mb-3">
                      <!-- Dynamic forms will be inserted here -->
                    </div>
                    <div class="text-center">
                      <button type="submit" class="btn btn-outline-primary">
                        <i class="fas fa-save"></i> Proses Pembayaran
                      </button>
                    </div>
                    <div class="mt-3 text-center" id="validation-message"></div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--Content body end-->

      <!--Footer start-->
      <div class="footer">
        <div class="copyright">
          <p>
            Copyright © Designed &amp; Developed by
            <a href="" target="_blank">_LnH'79</a>
            <span class="current-year">2024</span>
          </p>
        </div>
      </div>
      <!--Footer end-->
    </div>
    <!--Main wrapper end-->
    <!--Scripts-->
    <!-- Required vendors -->
    <script src="vendor/global/global.min.js"></script>
    <script src="vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="vendor/chart-js/chart.bundle.min.js"></script>
    <script src="vendor/owl-carousel/owl.carousel.js"></script>
    <script src="vendor/sweetalert2/dist/sweetalert2.min.js"></script>

    <script src="js/custom.min.js"></script>
    <script src="js/deznav-init.js"></script>

    <!-- Script theme mode start -->
    <script>
      jQuery(document).ready(function () {
        setTimeout(function () {
          dezSettingsOptions.version = "light";
          new dezSettings(dezSettingsOptions);
          setCookie("version", "light");
        }, 1500);
      });
    </script>
    <!-- Script theme mode end -->

    <script>
      $(document).ready(function () {
        const response = {
          fees: [
            {
              name: "LKS",
              amount: 500000,
              total_exempted: 100000,
              total_paid: 250000,
              outstanding_balance: 150000,
            },
            {
              name: "Tasyakuran",
              amount: 300000,
              total_exempted: 0,
              total_paid: 100000,
              outstanding_balance: 200000,
            },
            {
              name: "Ujian Kelulusan",
              amount: 200000,
              total_exempted: 0,
              total_paid: 0,
              outstanding_balance: 200000,
            },
          ],
        };

        function formatCurrency(amount) {
          return "Rp " + amount.toLocaleString("id-ID");
        }

        let html =
          '<table class="table table-striped table-hover table-responsive-sm">';
        html +=
          "<thead><tr><th>Jenis Iuran</th><th>Jumlah Iuran</th><th>Pembebasan</th><th>Sudah Dibayar</th><th>Sisa</th></tr></thead><tbody>";
        $.each(response.fees, function (index, fee) {
          html += "<tr>";
          html += "<td>" + fee.name + "</td>";
          html += "<td>" + formatCurrency(fee.amount) + "</td>";
          html += "<td>" + formatCurrency(fee.total_exempted) + "</td>";
          html += "<td>" + formatCurrency(fee.total_paid) + "</td>";
          html += "<td>" + formatCurrency(fee.outstanding_balance) + "</td>";
          html += "</tr>";
        });
        html += "</tbody></table>";
        $("#payment-details").html(html);

        let feeForms = "";
        $.each(response.fees, function (index, fee) {
          let rowIndex = index + 1;
          let isDisabled = fee.outstanding_balance === 0 ? "disabled" : "";
          feeForms += `
      <div class="row mb-3">
        <div class="col-lg-4 col-md-4 col-sm-12 mb-2">
          <label for="fee-name-${rowIndex}" class="form-label">Jenis Iuran</label>
          <input type="text" class="form-control" id="fee-name-${rowIndex}" value="${
            fee.name
          }" readonly>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-12 mb-2">
          <label for="amount-${rowIndex}" class="form-label">Jumlah yang Harus Dibayar</label>
          <input type="text" class="form-control" id="amount-${rowIndex}" value="${formatCurrency(
            fee.outstanding_balance
          )}" readonly>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-12 mb-2">
          <label for="fee-paid-${rowIndex}" class="form-label">Jumlah yang Dibayar</label>
          <input type="number" class="form-control" id="fee-paid-${rowIndex}" placeholder="Jumlah yang dibayar" min="0" ${isDisabled}>
        </div>
      </div>
    `;
        });
        feeForms += `
    <div class="row mb-3">
      <div class="col-lg-12 mb-2">
        <label for="total-paid" class="form-label">Total Dibayar</label>
        <input type="text" class="form-control" id="total-paid" value="Rp 0" readonly>
      </div>
    </div>
    `;
        $("#fee-forms").html(feeForms);

        function updateTotalPaid() {
          let totalPaid = 0;
          $.each(response.fees, function (index) {
            const paid = parseFloat($(`#fee-paid-${index + 1}`).val()) || 0;
            totalPaid += paid;
          });
          $("#total-paid").val(formatCurrency(totalPaid));
        }

        $("#fee-forms").on("input", "input[id^='fee-paid-']", function () {
          updateTotalPaid();
        });

        $("#payment-form").on("submit", function (e) {
          e.preventDefault();
          let isValid = false;
          for (let i = 1; i <= response.fees.length; i++) {
            const paid = parseFloat($(`#fee-paid-${i}`).val()) || 0;

            if (paid > 0) {
              isValid = true;
              break;
            }
          }

          if (!isValid) {
            $("#validation-message")
              .text("Anda harus membayar setidaknya satu jenis iuran.")
              .addClass("text-danger");
            Swal.fire(
              "Oops...",
              "Anda harus membayar setidaknya satu jenis iuran. !!",
              "error"
            );
          } else {
            $("#validation-message")
              .text("Pembayaran berhasil diproses.")
              .removeClass("text-danger")
              .addClass("text-success");
            Swal.fire("Okay...", "Pembayaran berhasil diproses.", "success");

            // Optional: Add the new data to the table or send it to the server
          }
        });
      });
    </script>
  </body>
</html>
